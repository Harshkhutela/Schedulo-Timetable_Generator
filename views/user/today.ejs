<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>Timetable Viewer</title>
  <script src="https://cdn.tailwindcss.com"></script>
  <style>
  body {
    font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
    background-color: #f7f7f7;
    color: #222;
  }

  .scroll-container {
    scrollbar-width: none; /* Firefox */
    -ms-overflow-style: none; /* IE and Edge */
  }

  .scroll-container::-webkit-scrollbar {
    display: none; /* Chrome/Safari */
  }

  .scroll-indicator {
    position: absolute;
    left: 0.45rem; /* Aligned center on line */
    width: 20px; /* Slightly bigger */
    height: 20px;
    background-color: #0F044C; /* Dark blue */
    border-radius: 50%;
    z-index: 20;
    box-shadow: 0 0 10px rgba(0,0,0,0.2);
    transition: top 0.2s ease;
  }
</style>

</head>

<!-- âœ… Add full-height flex layout -->
<body class="min-h-screen flex flex-col">

  <!-- âœ… Content Wrapper with flex-grow -->
  <div class="flex-grow">
    <!-- Header -->
<header class="bg-[#0F044C] shadow-md py-4 px-6 w-full">
  <div class="flex items-center justify-between max-w-7xl mx-auto">
    <!-- Left: Logo or Schedulo -->
    <div class="flex items-center space-x-3">
      <img src="/images/Logo.png" alt="Logo" class="h-10 md:h-14 filter brightness-0 invert" />
    </div>

    <!-- Desktop Nav Links -->
    <div class="hidden md:flex items-center space-x-4">
      <a href="/user/timetable" class="bg-[#0F044C] text-white px-4 py-2 rounded hover:bg-[#787A91] transition text-sm md:text-base">Full Timetable</a>
      <a href="/user/timetable/today" class="bg-[#0F044C] text-white px-4 py-2 rounded hover:bg-[#787A91] transition text-sm md:text-base">Todayâ€™s Timetable</a>
      <a href="/auth/logout" class="bg-[#0F044C] text-white px-4 py-2 rounded hover:bg-[#787A91] transition text-sm md:text-base">Logout</a>
    </div>

    <!-- Mobile Menu Button -->
    <div class="md:hidden relative">
      <button id="menuToggle" class="text-white focus:outline-none">
        <svg class="w-6 h-6" fill="none" stroke="currentColor" stroke-width="2"
             viewBox="0 0 24 24" stroke-linecap="round" stroke-linejoin="round">
          <path d="M4 6h16M4 12h16M4 18h16"/>
        </svg>
      </button>

      <!-- Dropdown Menu -->
      <div id="mobileMenu" class="absolute right-0 mt-2 w-48 bg-white rounded-md shadow-lg hidden z-50">
        <a href="/user/timetable" class="block px-4 py-2 text-gray-800 hover:bg-gray-100">Full Timetable</a>
        <a href="/user/timetable/today" class="block px-4 py-2 text-gray-800 hover:bg-gray-100">Todayâ€™s Timetable</a>
        <a href="/auth/logout" class="block px-4 py-2 text-gray-800 hover:bg-gray-100">Logout</a>
      </div>
    </div>
  </div>
</header>


    <!-- Main Content -->
    <main class="mt-10 px-6 max-w-5xl mx-auto">
      <h2 class="text-center text-2xl md:text-3xl font-bold mb-6 text-gray-800">Todayâ€™s Timetable (<%= today %>)</h2>

      <!-- Course Selector -->
      <form method="GET" action="/user/timetable/today" class="mb-6 flex flex-col md:flex-row justify-center items-center gap-4">
        <div>
          <label for="course" class="block text-sm font-medium text-gray-700 mb-1">ğŸ“ Select Course</label>
          <select name="course" id="course" class="w-64 px-3 py-2 border border-gray-300 rounded shadow-sm" onchange="this.form.submit()">
            <option value="">-- Select Course --</option>
            <% courses.forEach(course => { %>
              <option value="<%= course %>" <%= course === selectedCourse ? 'selected' : '' %>><%= course %></option>
            <% }) %>
          </select>
        </div>
      </form>

      <% if (!selectedCourse) { %>
        <p class="text-red-500 text-center">Please select a course to view todayâ€™s schedule.</p>
      <% } else if (!todaySchedule || todaySchedule.length === 0) { %>
        <p class="text-yellow-600 text-center">No lectures scheduled for <%= today %>.</p>
      <% } else { %>
        <div class="scroll-container max-h-[70vh] overflow-y-auto relative max-w-4xl mx-auto" id="scrollContainer">
  <!-- Scroll ball (over left line) -->
  <div class="scroll-indicator" id="scrollBall"></div>

  <div class="relative mt-6 pl-6 md:pl-10 pb-10">
    <!-- Vertical blue line -->
    <div class="absolute left-3 md:left-4 top-0 w-1 bg-[#0F044C] rounded" style="height: calc(100% - 40px);"></div>

    <% todaySchedule.forEach((entry) => { %>
      <!-- Schedule block (no change needed) -->
      <div class="flex flex-col md:flex-row md:items-start gap-2 md:gap-4 mb-6 relative group">

  <!-- Blue dot placed on vertical line -->
    <div class="absolute left-[-1.75rem] top-[1.15rem] w-3 h-3 bg-[#0F044C] rounded-full z-20"></div>

  <!-- Time -->
  <div class="w-full md:w-24 shrink-0 text-left md:text-right text-sm font-semibold text-[#0F044C] pt-1">
    <%= entry.time %>
  </div>

  <!-- Schedule card -->
  <div class="bg-white text-gray-800 rounded-2xl shadow-lg p-4 w-full hover:bg-gray-100 transition border border-gray-100">
    <div class="flex justify-between items-center mb-2">
      <div class="text-lg font-semibold tracking-wide"><%= entry.subject %></div>
      <% if (entry.type === 'Lab') { %>
        <span class="text-sm bg-green-200 text-green-800 px-2 py-1 rounded-full">Lab</span>
      <% } else if (entry.type === 'Free') { %>
        <span class="text-sm bg-gray-300 text-gray-700 px-2 py-1 rounded-full">Free</span>
      <% } else { %>
        <span class="text-sm bg-blue-200 text-blue-800 px-2 py-1 rounded-full">Lecture</span>
      <% } %>
    </div>
    <% if (entry.type !== 'Free') { %>
      <div class="text-sm mb-1">ğŸ‘¨â€ğŸ« <%= entry.teacher %></div>
      <div class="text-sm">ğŸ“ Room: <%= entry.room %></div>
    <% } else { %>
      <div class="text-sm italic text-gray-500">No session scheduled</div>
    <% } %>
  </div>

</div>

    <% }) %>
  </div>
</div>

      <% } %>
    </main>
  </div> <!-- âœ… End of flex-grow wrapper -->

  <!-- âœ… Footer stays at bottom -->
  <footer class="bg-[#0F044C] text-white text-center py-4">
     <p>Â©2025 Schedulo</p>
  <p>
    <a href="/about" class="underline hover:text-gray-300 transition">About Us</a>
  </p>
  </footer>
<script>
document.addEventListener("DOMContentLoaded", function () {
  // Scroll Ball
  const scrollContainer = document.getElementById('scrollContainer');
  const scrollBall = document.getElementById('scrollBall');

  if (scrollContainer && scrollBall) {
    scrollContainer.addEventListener('scroll', () => {
      const scrollTop = scrollContainer.scrollTop;
      const maxScroll = scrollContainer.scrollHeight - scrollContainer.clientHeight;
      const percentage = scrollTop / maxScroll;
      const maxBallPosition = scrollContainer.scrollHeight - 50;
      const topValue = percentage * maxBallPosition;
      scrollBall.style.top = `${topValue}px`;
    });
  }

  // Mobile Menu Toggle
  const menuToggle = document.getElementById('menuToggle');
  const mobileMenu = document.getElementById('mobileMenu');

  if (menuToggle && mobileMenu) {
    menuToggle.addEventListener('click', () => {
      mobileMenu.classList.toggle('hidden');
    });
  }
});
</script>

</body>
</html>
